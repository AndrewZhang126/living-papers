<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Binding Test</title>
    <script type="module" src="../src/components/observable-cell.js"></script>
    <script type="module" src="../src/components/dynamic-text.js"></script>
    <style>
      body { max-width: 800px; }
    </style>
    <script type="module">
      import { ObservableRuntime } from "../src/observable/runtime.js";
      window.runtime = ObservableRuntime.instance();
    </script>
  </head>
  <body>
    <h2>Binding Range Components</h2>
    <div>
      Variable: <obs-cell code="v = 0"></obs-cell><br/>
      <hr/>
      Drag me: <dynamic-text id="dt" value="20"></dynamic-text><br/>
      Or me: <dynamic-text id="ot" value="25"></dynamic-text><br/>
      <hr/>
      <obs-cell id="r0" code="viewof r0 = Inputs.range([-1000, 1000], {step:1, value:-5})"></obs-cell>
      <obs-cell id="r1" code="viewof r1 = Inputs.range([-1000, 1000], {step:1, value:10})"></obs-cell>
      Range Value Observers: [<obs-cell code="r0"></obs-cell>, <obs-cell code="r1"></obs-cell>]
      <script type="module">
        import { bindValue } from '../src/compile/bind-value.js';
        bindValue(runtime, 'v', document.querySelector('#r0'));
        bindValue(runtime, 'v', document.querySelector('#r1'));
        bindValue(runtime, 'v', document.querySelector('#dt'));
        bindValue(runtime, 'v', document.querySelector('#ot'));
      </script>
    </div>

    <h2>Binding Select Components</h2>
    <div>
      Variable: <obs-cell code="s = 'a'"></obs-cell><br/>
      <hr/>
      <obs-cell id="s0" code="viewof s0 = Inputs.select(['a', 'b', 'c'])"></obs-cell>
      <obs-cell id="s1" code="viewof s1 = Inputs.select(['a', 'b', 'c'])"></obs-cell>
      Select Value Observers: [<obs-cell code="s0"></obs-cell>, <obs-cell code="s1"></obs-cell>]
      <script type="module">
        import { bindValue } from '../src/compile/bind-value.js';
        bindValue(runtime, 's', document.querySelector('#s0'));
        bindValue(runtime, 's', document.querySelector('#s1'));
      </script>
    </div>

    <h2>Assignment Handlers</h2>
    <div>
      <button id="b0">Assign Values</button>
      <button id="b1">Reset Range</button>
      <button id="b2">Reset Select</button><br/>
      <script type="module">
        const b0 = document.querySelector('#b0');
        const b1 = document.querySelector('#b1');
        const b2 = document.querySelector('#b2');
        b0.addEventListener('click', runtime.handler('(v = 100, s = "c")'));
        b1.addEventListener('click', runtime.handler('v = 0'));
        b2.addEventListener('click', runtime.handler('s = "a"'));
      </script>
    </div>
  </body>
</html>
